<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>SPMD Multidimensionnal Views</title>
<link rel="stylesheet" href="../../../../src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../../../../index.html" title="HPX 1.1.0">
<link rel="up" href="../partitioned_vector_views.html" title="Using Views">
<link rel="prev" href="spmd_block.html" title="Preface : Why SPMD ?">
<link rel="next" href="../c_co_arrays.html" title="C++ Co-Arrays">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"><img alt="HPX" width="531" height="105" src="../../../../images/hpx_1_1_0_draft.png"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="spmd_block.html"><img src="../../../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../partitioned_vector_views.html"><img src="../../../../images/up.png" alt="Up"></a><a accesskey="h" href="../../../../index.html"><img src="../../../../images/home.png" alt="Home"></a><a accesskey="n" href="../c_co_arrays.html"><img src="../../../../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h5 class="title">
<a name="hpx.manual.containers.partitioned_vector_views.spmd_views"></a><a class="link" href="spmd_views.html" title="SPMD Multidimensionnal Views">SPMD
          Multidimensionnal Views</a>
</h5></div></div></div>
<div class="toc"><dl class="toc">
<dt><span class="section"><a href="spmd_views.html#hpx.manual.containers.partitioned_vector_views.spmd_views.Subscripts">Subscript-based
            operations</a></span></dt>
<dt><span class="section"><a href="spmd_views.html#hpx.manual.containers.partitioned_vector_views.spmd_views.ViewIterators">Iterator-based
            operations</a></span></dt>
<dt><span class="section"><a href="spmd_views.html#hpx.manual.containers.partitioned_vector_views.spmd_views.SubViews">Instanciating
            Sub-views</a></span></dt>
</dl></div>
<p>
            Some classes are defined as "container views" when the purpose
            is to observe and/or modify the values of a container using another perspective
            than the one that characterizes the container. For example, the values
            of an <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span></code> object can be accessed via the
            expression <code class="computeroutput"><span class="identifier">v</span><span class="special">[</span><span class="identifier">i</span><span class="special">]</span></code>.
            Container views can be used, for example, when it is desired for those
            values to be "viewed" as a 2D matrix that would have been flattened
            in a <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span></code>. The values would be possibly
            accessible via the expression <code class="computeroutput"><span class="identifier">vv</span><span class="special">(</span><span class="identifier">i</span><span class="special">,</span><span class="identifier">j</span><span class="special">)</span></code> which would call internally the expression
            <code class="computeroutput"><span class="identifier">v</span><span class="special">[</span><span class="identifier">k</span><span class="special">]</span></code>.
          </p>
<p>
            By default, the <code class="computeroutput"><span class="identifier">partitioned_vector</span></code>
            class integrates 1-D views of its segments :
          </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">include</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// The following code generates all necessary boiler plate to enable the</span>
<span class="comment">// remote creation of 'partitioned_vector' segments</span>
<span class="comment">//</span>
<code class="computeroutput">HPX_REGISTER_PARTITIONED_VECTOR</code><span class="special">(</span><span class="keyword">double</span><span class="special">);</span>

<span class="keyword">using</span> <span class="identifier">iterator</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;::</span><span class="identifier">iterator</span><span class="special">;</span>
<span class="keyword">using</span> <span class="identifier">traits</span>   <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">traits</span><span class="special">::</span><span class="identifier">segmented_iterator_traits</span><span class="special">&lt;</span><span class="identifier">iterator</span><span class="special">&gt;;</span>

<span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">v</span><span class="special">;</span>

<span class="comment">// Create a 1-D view of the vector of segments</span>
<span class="keyword">auto</span> <span class="identifier">vv</span> <span class="special">=</span> <span class="identifier">traits</span><span class="special">::</span><span class="identifier">segment</span><span class="special">(</span><span class="identifier">v</span><span class="special">.</span><span class="identifier">begin</span><span class="special">());</span>

<span class="comment">// Access segment i</span>
<span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">v</span> <span class="special">=</span> <span class="identifier">vv</span><span class="special">[</span><span class="identifier">i</span><span class="special">];</span>
</pre>
<p>
            Our views are called "multi-dimensional" in the sense that
            they generalize to N dimensions the purpose of <code class="computeroutput"><span class="identifier">segmented_iterator_traits</span><span class="special">::</span><span class="identifier">segments</span><span class="special">()</span></code> in the 1-D case. Note that in a parallel
            section, the 2-D expression <code class="computeroutput"><span class="identifier">a</span><span class="special">(</span><span class="identifier">i</span><span class="special">,</span><span class="identifier">j</span><span class="special">)</span> <span class="special">=</span> <span class="identifier">b</span><span class="special">(</span><span class="identifier">i</span><span class="special">,</span><span class="identifier">j</span><span class="special">)</span></code> is quite confusing because without convention,
            each of the images invoked will race to execute the statement. For this
            reason, our views are not only multi-dimensional but also "spmd-aware".
          </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
              Spmd-awareness: The convention is simple. If an assignment statement
              contains a view subscript as an l-value, it is only and only the image
              holding the r-value who is evaluating the statement. (In MPI sense,
              it is called a Put operation)
            </p></td></tr>
</table></div>
<div class="section">
<div class="titlepage"><div><div><h6 class="title">
<a name="hpx.manual.containers.partitioned_vector_views.spmd_views.Subscripts"></a><a class="link" href="spmd_views.html#hpx.manual.containers.partitioned_vector_views.spmd_views.Subscripts" title="Subscript-based operations">Subscript-based
            operations</a>
</h6></div></div></div>
<p>
              Here are some examples of using subscripts in the 2-D view case:
            </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">components</span><span class="special">/</span><span class="identifier">containers</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">/</span><span class="identifier">partitioned_vector_view</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">include</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// The following code generates all necessary boiler plate to enable the</span>
<span class="comment">// remote creation of 'partitioned_vector' segments</span>
<span class="comment">//</span>
<code class="computeroutput">HPX_REGISTER_PARTITIONED_VECTOR</code><span class="special">(</span><span class="keyword">double</span><span class="special">);</span>

<span class="keyword">using</span> <span class="identifier">Vec</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;;</span>
<span class="keyword">using</span> <span class="identifier">View_2D</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector_view</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">,</span><span class="number">2</span><span class="special">&gt;;</span>

<span class="comment">/* Do some code */</span>

<span class="identifier">Vec</span> <span class="identifier">v</span><span class="special">;</span>

<span class="comment">// Parallel section (suppose 'block' an spmd_block instance)</span>
<span class="special">{</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">height</span><span class="special">,</span> <span class="identifier">width</span><span class="special">;</span>

    <span class="comment">// Instanciate the view</span>
    <span class="identifier">View_2D</span> <span class="identifier">vv</span><span class="special">(</span><span class="identifier">block</span><span class="special">,</span> <span class="identifier">v</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">v</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="special">{</span><span class="identifier">height</span><span class="special">,</span><span class="identifier">width</span><span class="special">});</span>

    <span class="comment">// The l-value is a view subscript, the image that owns vv(1,0)</span>
    <span class="comment">// evaluates the assignment.</span>
    <span class="identifier">vv</span><span class="special">(</span><span class="number">0</span><span class="special">,</span><span class="number">1</span><span class="special">)</span> <span class="special">=</span> <span class="identifier">vv</span><span class="special">(</span><span class="number">1</span><span class="special">,</span><span class="number">0</span><span class="special">);</span>

    <span class="comment">// The l-value is a view subscript, the image that owns the r-value</span>
    <span class="comment">// (result of expression 'std::vector&lt;double&gt;(4,1.0)') evaluates the</span>
    <span class="comment">// assignment : oops! race between all participating images.</span>
    <span class="identifier">vv</span><span class="special">(</span><span class="number">2</span><span class="special">,</span><span class="number">3</span><span class="special">)</span> <span class="special">=</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;(</span><span class="number">4</span><span class="special">,</span><span class="number">1.0</span><span class="special">);</span>
<span class="special">}</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h6 class="title">
<a name="hpx.manual.containers.partitioned_vector_views.spmd_views.ViewIterators"></a><a class="link" href="spmd_views.html#hpx.manual.containers.partitioned_vector_views.spmd_views.ViewIterators" title="Iterator-based operations">Iterator-based
            operations</a>
</h6></div></div></div>
<p>
              Here are some examples of using iterators in the 3-D view case :
            </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">components</span><span class="special">/</span><span class="identifier">containers</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">/</span><span class="identifier">partitioned_vector_view</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">include</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// The following code generates all necessary boiler plate to enable the</span>
<span class="comment">// remote creation of 'partitioned_vector' segments</span>
<span class="comment">//</span>
<code class="computeroutput">HPX_REGISTER_PARTITIONED_VECTOR</code><span class="special">(</span><span class="keyword">int</span><span class="special">);</span>

<span class="keyword">using</span> <span class="identifier">Vec</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;;</span>
<span class="keyword">using</span> <span class="identifier">View_3D</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector_view</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span><span class="number">3</span><span class="special">&gt;;</span>

<span class="comment">/* Do some code */</span>

<span class="identifier">Vec</span> <span class="identifier">v1</span><span class="special">,</span> <span class="identifier">v2</span><span class="special">;</span>

<span class="comment">// Parallel section (suppose 'block' an spmd_block instance)</span>
<span class="special">{</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">sixe_x</span><span class="special">,</span> <span class="identifier">size_y</span><span class="special">,</span> <span class="identifier">size_z</span><span class="special">;</span>

    <span class="comment">// Instanciate the views</span>
    <span class="identifier">View_3D</span> <span class="identifier">vv1</span><span class="special">(</span><span class="identifier">block</span><span class="special">,</span> <span class="identifier">v1</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">v1</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="special">{</span><span class="identifier">sixe_x</span><span class="special">,</span><span class="identifier">size_y</span><span class="special">,</span><span class="identifier">size_z</span><span class="special">});</span>
    <span class="identifier">View_3D</span> <span class="identifier">vv2</span><span class="special">(</span><span class="identifier">block</span><span class="special">,</span> <span class="identifier">v2</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">v2</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="special">{</span><span class="identifier">sixe_x</span><span class="special">,</span><span class="identifier">size_y</span><span class="special">,</span><span class="identifier">size_z</span><span class="special">});</span>

    <span class="comment">// Save previous segments covered by vv1 into segments covered by vv2</span>
    <span class="keyword">auto</span> <span class="identifier">vv2_it</span> <span class="special">=</span> <span class="identifier">vv2</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
    <span class="keyword">auto</span> <span class="identifier">vv1_it</span> <span class="special">=</span> <span class="identifier">vv1</span><span class="special">.</span><span class="identifier">cbegin</span><span class="special">();</span>

    <span class="keyword">for</span><span class="special">(;</span> <span class="identifier">vv2_it</span> <span class="special">!=</span> <span class="identifier">vv2</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="identifier">vv2_it</span><span class="special">++,</span> <span class="identifier">vv1_it</span><span class="special">++)</span>
    <span class="special">{</span>
        <span class="comment">// It's a Put operation</span>
        <span class="special">*</span><span class="identifier">vv2_it</span> <span class="special">=</span> <span class="special">*</span><span class="identifier">vv1_it</span><span class="special">;</span>
    <span class="special">}</span>

    <span class="comment">// Ensure that all images have performed their Put operations</span>
    <span class="identifier">block</span><span class="special">.</span><span class="identifier">sync_all</span><span class="special">();</span>

    <span class="comment">// Ensure that only one image is putting updated data into the different</span>
    <span class="comment">// segments covered by vv1</span>
    <span class="keyword">if</span><span class="special">(</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">this_image</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">)</span>
    <span class="special">{</span>
        <span class="keyword">int</span> <span class="identifier">idx</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>

        <span class="comment">// Update all the segments covered by vv1</span>
        <span class="keyword">for</span><span class="special">(</span><span class="keyword">auto</span> <span class="identifier">i</span> <span class="special">=</span> <span class="identifier">vv1</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span> <span class="identifier">i</span> <span class="special">!=</span> <span class="identifier">vv1</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="identifier">i</span><span class="special">++)</span>
        <span class="special">{</span>
            <span class="comment">// It's a Put operation</span>
            <span class="special">*</span><span class="identifier">i</span> <span class="special">=</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">&gt;(</span><span class="identifier">elt_size</span><span class="special">,</span><span class="identifier">idx</span><span class="special">++);</span>
        <span class="special">}</span>
    <span class="special">}</span>
<span class="special">}</span>
</pre>
<p>
              Here is an example that shows how to iterate only over segments owned
              by the current image :
            </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">components</span><span class="special">/</span><span class="identifier">containers</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">/</span><span class="identifier">partitioned_vector_view</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">components</span><span class="special">/</span><span class="identifier">containers</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">/</span><span class="identifier">partitioned_vector_local_view</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">include</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// The following code generates all necessary boiler plate to enable the</span>
<span class="comment">// remote creation of 'partitioned_vector' segments</span>
<span class="comment">//</span>
<code class="computeroutput">HPX_REGISTER_PARTITIONED_VECTOR</code><span class="special">(</span><span class="keyword">float</span><span class="special">);</span>

<span class="keyword">using</span> <span class="identifier">Vec</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">&gt;;</span>
<span class="keyword">using</span> <span class="identifier">View_1D</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector_view</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">,</span><span class="number">1</span><span class="special">&gt;;</span>

<span class="comment">/* Do some code */</span>

<span class="identifier">Vec</span> <span class="identifier">v</span><span class="special">;</span>

<span class="comment">// Parallel section (suppose 'block' an spmd_block instance)</span>
<span class="special">{</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">num_segments</span><span class="special">;</span>

    <span class="comment">// Instanciate the view</span>
    <span class="identifier">View_1D</span> <span class="identifier">vv</span><span class="special">(</span><span class="identifier">block</span><span class="special">,</span> <span class="identifier">v</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">v</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="special">{</span><span class="identifier">num_segments</span><span class="special">});</span>

    <span class="comment">// Instanciate the local view from the view</span>
    <span class="keyword">auto</span> <span class="identifier">local_vv</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">local_view</span><span class="special">(</span><span class="identifier">vv</span><span class="special">);</span>

    <span class="keyword">for</span> <span class="special">(</span> <span class="keyword">auto</span> <span class="identifier">i</span> <span class="special">=</span> <span class="identifier">localvv</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span> <span class="identifier">i</span> <span class="special">!=</span> <span class="identifier">localvv</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="identifier">i</span><span class="special">++</span> <span class="special">)</span>
    <span class="special">{</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">&gt;</span> <span class="special">&amp;</span> <span class="identifier">segment</span> <span class="special">=</span> <span class="special">*</span><span class="identifier">i</span><span class="special">;</span>

        <span class="comment">/* Do some code */</span>
    <span class="special">}</span>

<span class="special">}</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h6 class="title">
<a name="hpx.manual.containers.partitioned_vector_views.spmd_views.SubViews"></a><a class="link" href="spmd_views.html#hpx.manual.containers.partitioned_vector_views.spmd_views.SubViews" title="Instanciating Sub-views">Instanciating
            Sub-views</a>
</h6></div></div></div>
<p>
              It is possible to construct views from other views : we call it sub-views.
              The constraint nevertheless for the subviews is to retain the dimension
              and the value type of the input view. Here is an example showing how
              to create a sub-view.
            </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">components</span><span class="special">/</span><span class="identifier">containers</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">/</span><span class="identifier">partitioned_vector_view</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">hpx</span><span class="special">/</span><span class="identifier">include</span><span class="special">/</span><span class="identifier">partitioned_vector</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// The following code generates all necessary boiler plate to enable the</span>
<span class="comment">// remote creation of 'partitioned_vector' segments</span>
<span class="comment">//</span>
<code class="computeroutput">HPX_REGISTER_PARTITIONED_VECTOR</code><span class="special">(</span><span class="keyword">float</span><span class="special">);</span>

<span class="keyword">using</span> <span class="identifier">Vec</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">&gt;;</span>
<span class="keyword">using</span> <span class="identifier">View_2D</span> <span class="special">=</span> <span class="identifier">hpx</span><span class="special">::</span><span class="identifier">partitioned_vector_view</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">,</span><span class="number">2</span><span class="special">&gt;;</span>

<span class="comment">/* Do some code */</span>

<span class="identifier">Vec</span> <span class="identifier">v</span><span class="special">;</span>

<span class="comment">// Parallel section (suppose 'block' an spmd_block instance)</span>
<span class="special">{</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">N</span> <span class="special">=</span> <span class="number">20</span><span class="special">;</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">tilesize</span> <span class="special">=</span> <span class="number">5</span><span class="special">;</span>

    <span class="comment">// Instanciate the view</span>
    <span class="identifier">View_2D</span> <span class="identifier">vv</span><span class="special">(</span><span class="identifier">block</span><span class="special">,</span> <span class="identifier">v</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">v</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="special">{</span><span class="identifier">N</span><span class="special">,</span><span class="identifier">N</span><span class="special">});</span>

    <span class="comment">// Instanciate the subview</span>
    <span class="identifier">View_2D</span> <span class="identifier">svv</span><span class="special">(</span>
        <span class="identifier">block</span><span class="special">,&amp;</span><span class="identifier">v</span><span class="special">(</span><span class="identifier">tilesize</span><span class="special">,</span><span class="number">0</span><span class="special">),&amp;</span><span class="identifier">v</span><span class="special">(</span><span class="number">2</span><span class="special">*</span><span class="identifier">tilesize</span><span class="special">-</span><span class="number">1</span><span class="special">,</span><span class="identifier">tilesize</span><span class="special">-</span><span class="number">1</span><span class="special">),{</span><span class="identifier">tilesize</span><span class="special">,</span><span class="identifier">tilesize</span><span class="special">},{</span><span class="identifier">N</span><span class="special">,</span><span class="identifier">N</span><span class="special">});</span>

    <span class="keyword">if</span><span class="special">(</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">this_image</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">)</span>
    <span class="special">{</span>
        <span class="comment">// Equivalent to 'sv(tilesize,0) = 2.0f'</span>
        <span class="identifier">svv</span><span class="special">(</span><span class="number">0</span><span class="special">,</span><span class="number">0</span><span class="special">)</span> <span class="special">=</span> <span class="number">2.0f</span><span class="special">;</span>

        <span class="comment">// Equivalent to 'sv(2*tilesize-1,tilesize-1) = 3.0f'</span>
        <span class="identifier">svv</span><span class="special">(</span><span class="identifier">tilesize</span><span class="special">-</span><span class="number">1</span><span class="special">,</span><span class="identifier">tilesize</span><span class="special">-</span><span class="number">1</span><span class="special">)</span> <span class="special">=</span> <span class="number">3.0f</span><span class="special">;</span>
    <span class="special">}</span>

<span class="special">}</span>
</pre>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
                The last parameter of the subview constructor is the size of the
                original view. If one would like to create a subview of the subview
                and so on, this parameter should stay unchanged. (<code class="computeroutput"><span class="special">{</span><span class="identifier">N</span><span class="special">,</span><span class="identifier">N</span><span class="special">}</span></code>
                for the above example)
              </p></td></tr>
</table></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2011-2017 The STE||AR Group (http://stellar-group.org)<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">LICENSE_1_0.txt</a>
        or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="spmd_block.html"><img src="../../../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../partitioned_vector_views.html"><img src="../../../../images/up.png" alt="Up"></a><a accesskey="h" href="../../../../index.html"><img src="../../../../images/home.png" alt="Home"></a><a accesskey="n" href="../c_co_arrays.html"><img src="../../../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
